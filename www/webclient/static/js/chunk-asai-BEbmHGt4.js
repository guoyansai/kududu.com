const e=console.log,t=function(e,t){if(!e)throw t};function n(e,t){if(!e)return 0;var n=e.toString().split(".");return n.length>1?parseInt(n[0],t)+parseInt(n[1],t)/Math.pow(t,n[1].length):parseInt(n[0],t)}let o=[" ","\n","\t","\r"];const r=new Proxy({r:"\r",n:"\n",t:"\t",'"':'"',"'":"'","\\":"\\"},{get:(e,t)=>n(t)});let i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","t","u","v","w","h","i","j","k","l","m","n","o","p","q","r","s","x","y","z"],l=["0","1","2","3","4","5","6","7","8","9"],s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","A","B","C","D","E","F"],u=["0","1"],T=["+","-","*",")",";","/","^","%","#",",","{","}",":","[","]","(",".","`"],p=["~","=",">","<"],c=["+","-","*","/","^","..","%","//"],f=["+=","-=","*=","/=","^=","..=","%=","//="],k=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","continue"],L=["continue","goto"],y=["else","elseif","until","end"],S=["-","not","#","~"],h=["+","-","*","/","%","^","#","//","&","|","~","<<",">>","..",".",":",">","<","<=",">=","~=","==","+=","-=","*=","/=","%=","^=","..=","//=","and","or"],d={"^":[13,12],"%":[10,10],"//":[10,10],"/":[10,10],"*":[10,10],"+":[9,9],"-":[9,9],"..":[8,7],">>":[7,7],"<<":[7,7],"&":[6,6],"~":[5,5],"|":[4,4],"==":[3,3],"~=":[3,3],">=":[3,3],"<=":[3,3],">":[3,3],"<":[3,3],"+=":[3,3],"-=":[3,3],"*=":[3,3],"/=":[3,3],"^=":[3,3],"%=":[3,3],"..=":[3,3],"//=":[3,3],and:[2,2],or:[1,1]};function E(n){let E,_,m=function(t){let n=0,f=t.length,L=[];function y(e){return e=e||0,n<=f?t.substr(n+e,1):""}function S(){if(n<=f){let e=t.substr(n,1);return n++,e}return""}function d(o){let r,i=1,a=1;for(;0<=n;)"\n"==t.substr(0,1)?(i++,a=1):a++;for(r=0;r<L.length;r++){let t=L[r];e(`${t.Type}<${t.Source}>`)}throw`file<${i}:${a}>: ${o}`}function E(e){for(;;){let t=S();if(""==t)d("Unfinished long string.");else if("]"==t){let t,o=!0;for(t=1;t<=e;t++){if("="!=y()){o=!1;break}n++}if(o&&"]"==S())return}}}function _(){let e=n;for(;"="==y();)n++;return"["==y()?(n++,n-e-1):void(n=e)}let m=0,g=0;function C(e){let o=t.substr(g,n-g),r=null;"Number"==e&&(o=o.replace(/[\_]+/g,""),"0x"==o.substr(0,2).toLowerCase()?(r="hex",parseInt(o,16)<999999999999&&(o=parseInt(o,16))):"0b"==o.substr(0,2).toLowerCase()&&(r="bin",parseInt(o.substr(2),2)<999999999999&&(o=parseInt(o.substr(2),2))));let i={Type:e,LeadingWhite:t.substr(m,g-m),Source:o};return null!==r&&(i.NType=r),L.push(i),m=n,g=n,i}for(;;){for(m=n;;){let e=y();if(""==e)break;if("-"==e){if("-"!=y(1))break;if(n+=2,"["==y()){n++;let e=_();if(null!=e)E(e),m=n;else for(;;){let e=S();if(""==e||"\n"==e)break}}else for(;;){let e=S();if(""==e||"\n"==e)break}}else{if(!o.includes(e))break;n++}}t.substr(m,n-m),g=n;let e=S();if(""==e){C("Eof");break}if("'"==e||'"'==e){for(;;){let t=S();if("\\"==t){let e=S();if(null==r[e])throw`Invalid Escape Sequence \`${e}\`.`}else{if(t==e)break;if(""==t)throw"Unfinished string!"}}C("String")}else if("`"==e){for(;;){let t=S();if("\\"==t){let e=S();if(null==r[e])throw`Invalid Escape Sequence \`${e}\`.`}else{if(t==e)break;if(""==t)throw"Unfinished string!"}}C("Hash")}else if(i.includes(e)){for(;a.includes(y());)n++;k.includes(t.substr(g,n-g))?C("Keyword"):C("Ident")}else if(l.includes(e)||"."==e&&l.includes(y())){if("0"==e&&"x"==y().toLowerCase())for(n++;s.includes(y())||"_"===y();)n++;else if("0"==e&&"b"==y().toLowerCase())for(n++;u.includes(y())||"_"===y();)n++;else{for(;l.includes(y())||"_"===y();)n++;if("."==y())for(n++;l.includes(y());)n++;if("e"==y()||"E"==y())for(n++,"-"!=y()&&"+"!=y()||n++;l.includes(y());)n++}C("Number")}else if("["==e){let e=_();null!=e?(E(e),C("String")):C("Symbol")}else if("."==e)"."==y()&&(S(),("."==y()||"="==y())&&S()),C("Symbol");else if(e+y()=="//")S(),"="==y()&&S(),C("Symbol");else if(e+y()=="::")S(),C("Symbol");else if(h.includes(e+y()))S(),C("Symbol");else if(p.includes(e))"="==y()&&n++,C("Symbol");else if(c.includes(e)&&"="==y())S(),C("Symbol");else{if(!T.includes(e))throw`Bad symbol \`${e}\` in source. ${n}`;C("Symbol")}}return L}(n),g=0;function C(){let e=m[g];return g<m.length&&g++,e}function F(e){return m[e=g+(e||0)]||m[m.length-1]}function x(e){let t=1,n=0,o=0;for(;;){let r,i,a=m[o];for(r=a==e?a.LeadingWhite:a.LeadingWhite+a.Source,i=0;i<=r.length;i++){"\n"==r.substr(i,1)?(t++,n=0):n++}if(a==e)break;o++}return`${t}:${n+1}`}function b(){let e=F();return"Eof"==e.Type||"Keyword"==e.Type&&y.includes(e.Source)}function G(t,n){let o=F();if(o.Type!=t||null!=n&&o.Source!=n){if("Keyword"!=o.Type||"Ident"!=t||!L.includes(o.Source)||null!=n&&o.Source!=n){let r;for(r=-3;r<=3;r++)e(`Tokens[${r}] = \`${F(r).Source}\``);if(n){throw`${x(o)}: \`${n}\` expected.`}throw`${x(o)}: ${t} expected.`}return C()}return C()}function B(e){let n=e.GetFirstToken,o=e.GetLastToken,r=e;return e.GetFirstToken=function(){let e=n(r);return t(e),e},e.GetLastToken=function(){let e=o(r);return t(e),e},e}function R(e,t){let n=[_(e,t)],o=[];for(;","==F().Source;)o.push(C()),n.push(_(e,t));return[n,o]}function V(t,n){var o,r,i,a;let l=F();if("("==l.Source){let e,o=C(),r=_(t,n),i=G("Symbol",")");return e=B({Type:"ParenExpr",Expression:r,Token_OpenParen:o,Token_CloseParen:i,GetFirstToken:()=>e.Token_OpenParen,GetLastToken:()=>e.Token_CloseParen}),e}if("Ident"==l.Type||"Keyword"==l.Type&&L.includes(l.Source)){let e;return e=B({Type:"VariableExpr",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),null!=t[e.Token.Source]&&null!=(null==(r=null==(o=t[e.Token.Source])?void 0:o.Tokens)?void 0:r.push)?(t[e.Token.Source].Tokens.push(e.Token),t[e.Token.Source].UseCountIncrease()):null!=n[e.Token.Source]&&null!=(null==(a=null==(i=n[e.Token.Source])?void 0:i.Tokens)?void 0:a.push)&&(n[e.Token.Source].Tokens.push(e.Token),n[e.Token.Source].UseCountIncrease()),e}throw e(function(){let e=F();return`<${e.Type} \`${e.Source}\`> at: ${x(e)}`}()),`${x(l)}: Unexpected symbol. ${l.Type} ${l.Source}`}function A(e,t){let n=[],o=[];if("Ident"==F().Type||"Keyword"==F().Type&&L.includes(F().Source)){let e=C();if(t&&"<"==F().Source&&">"==F(2).Source){let t=F(1).Source;e.Attribute={LeadingWhite:F().LeadingWhite,Source:`<${t}>`},C(),C(),C()}n.push(e)}else if("..."==F().Source&&e)return[n,o,C()];for(;","==F().Source;){if(o.push(C()),"..."==F().Source&&e)return[n,o,C()];{let e=G("Ident");if(t&&"<"==F().Source&&">"==F(2).Source){let t=F(1).Source;e.Attribute={LeadingWhite:F().LeadingWhite,Source:`<${t}>`},C(),C(),C()}n.push(e)}}return[n,o]}function I(t,n,o){let r=E(n,o),i=F();if("Keyword"==i.Type&&i.Source==t)return C(),[r,i];throw e(i.Type,i.Source),`${x(i)}: ${t} expected.`}function N(e,t,n,o){let r,i,a=C();if(!e){r=[],i=[];let e=G("Ident");for(r.push(e);"."==F().Source;)i.push(C()),r.push(G("Ident"));":"==F().Source&&(i.push(C()),r.push(G("Ident")))}let l,s=G("Symbol","("),[u,T,p]=A(!0),c=G("Symbol",")"),[f,k]=I("end",t,n);return l=B({Type:1==e?"FunctionLiteral":"FunctionStat",NameChain:r,ArgList:u,Body:f,Token_Function:a,Token_NameChainSeperator:i,Token_OpenParen:s,Token_Varg:p,Token_ArgCommaList:T,Token_CloseParen:c,Token_End:k,GetFirstToken:()=>l.Token_Function,GetLastToken:()=>l.Token_End}),l}function P(e,t){let n=F();if("("==n.Source){let n=C(),o=[],r=[];for(;")"!=F().Source&&(o.push(_(e,t)),","==F().Source);)r.push(C());let i,a=G("Symbol",")");return i=B({CallType:"ArgCall",ArgList:o,Token_CommaList:r,Token_OpenParen:n,Token_CloseParen:a,GetFirstToken:()=>i.Token_OpenParen,GetLastToken:()=>i.Token_CloseParen}),i}if("{"==n.Source){let n;return n=B({CallType:"TableCall",TableExpr:_(e,t),GetFirstToken:()=>n.TableExpr.GetFirstToken(),GetLastToken:()=>n.TableExpr.GetLastToken()}),n}if("String"==n.Type){let e;return e=B({CallType:"StringCall",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}throw"Function arguments expected."}function $(e,n){let o=V(e,n);for(t(o,"nil prefixexpr");;){let t=F();if("."==t.Source){let e,t=C(),n=G("Ident");e=B({Type:"FieldExpr",Base:o,Field:n,Token_Dot:t,GetFirstToken:()=>e.Base.GetFirstToken(),GetLastToken:()=>e.Field}),o=e}else if(":"==t.Source){let t,r=C(),i=G("Ident"),a=P(e,n);t=B({Type:"MethodExpr",Base:o,Method:i,FunctionArguments:a,Token_Colon:r,GetFirstToken:()=>t.Base.GetFirstToken(),GetLastToken:()=>t.FunctionArguments.GetLastToken()}),o=t}else if("["==t.Source){let t,r=C(),i=_(e,n),a=G("Symbol","]");t=B({Type:"IndexExpr",Base:o,Index:i,Token_OpenBracket:r,Token_CloseBracket:a,GetFirstToken:()=>t.Base.GetFirstToken(),GetLastToken:()=>t.Token_CloseBracket}),o=t}else if("{"==t.Source||"("==t.Source||"String"==t.Type){let t;t=B({Type:"CallExpr",Base:o,FunctionArguments:P(e,n),GetFirstToken:()=>t.Base.GetFirstToken(),GetLastToken:()=>t.FunctionArguments.GetLastToken()}),o=t}else{if(!f.includes(t.Source))return o;{let t,r=C(),i=_(e,n);t=B({Type:"CompoundStat",Base:o,Token_Compound:r,Rhs:i,Lhs:o,GetFirstToken:()=>t.Base.GetFirstToken(),GetLastToken:()=>t.Rhs.GetLastToken()}),o=t}}}}function w(e,t){let n=F();if("Number"==n.Type){let e;return e=B({Type:"NumberLiteral",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("String"==n.Type){let e;return e=B({Type:"StringLiteral",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("Hash"==n.Type){let e;return e=B({Type:"HashLiteral",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("nil"==n.Source){let e;return e=B({Type:"NilLiteral",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("true"==n.Source||"false"==n.Source){let e;return e=B({Type:"BooleanLiteral",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}if("..."==n.Source){let e;return e=B({Type:"VargLiteral",Token:C(),GetFirstToken:()=>e.Token,GetLastToken:()=>e.Token}),e}return"{"==n.Source?function(e,t){let n=G("Symbol","{"),o=[],r=[];for(;"}"!=F().Source;){if("["==F().Source){let n=C(),r=_(e,t),i=G("Symbol","]"),a=G("Symbol","="),l=_(e,t);r.Token&&r.Token.Source,o.push({EntryType:"Index",Index:r,Value:l,Token_OpenBracket:n,Token_CloseBracket:i,Token_Equals:a})}else if(("Ident"==F().Type||"Keyword"==F().Type&&L.includes(F().Source))&&"="==F(1).Source){let n=C(),r=C(),i=_(e,t);o.push({EntryType:"Field",Field:n,Value:i,Token_Equals:r})}else{let n=_(e,t);o.push({EntryType:"Value",Value:n})}if(","!=F().Source&&";"!=F().Source)break;r.push(C())}let i,a=G("Symbol","}");return i=B({Type:"TableLiteral",EntryList:o,Token_SeperatorList:r,Token_OpenBrace:n,Token_CloseBrace:a,GetFirstToken:()=>i.Token_OpenBrace,GetLastToken:()=>i.Token_CloseBrace}),i}(e,t):"function"==n.Source?N(!0,e,t):$(e,t)}function O(e,n,o){let r;if(S.includes(F().Source)){let e,t=C(),i=O(11,n,o);e=B({Type:"UnopExpr",Token_Op:t,Rhs:i,GetFirstToken:()=>e.Token_Op,GetLastToken:()=>e.Rhs.GetLastToken()}),r=e}else r=w(n,o),t(r,"nil sipleexpr");for(;h.includes(F().Source)&&null!=d[F().Source]&&d[F().Source][0]>e;){let e,i=C(),a=O(d[i.Source][1],n,o);t(a,"RhsNeeded"),e=B({Type:"BinopExpr",Lhs:r,Rhs:a,Token_Op:i,GetFirstToken:()=>e.Lhs.GetFirstToken(),GetLastToken:()=>e.Rhs.GetLastToken()}),r=e}return r}function v(e,t){let n=$(e,t);if("MethodExpr"==n.Type||"CallExpr"==n.Type){let e;return e=B({Type:"CallExprStat",Expression:n,GetFirstToken:()=>e.Expression.GetFirstToken(),GetLastToken:()=>e.Expression.GetLastToken()}),e}if("CompoundStat"==n.Type)return n;{let o=[n],r=[];for(n.IsStat=!0;","==F().Source;){r.push(C());let n=$(e,t);if("MethodExpr"==n.Type||"CallExpr"==n.Type)throw"Bad left hand side of asignment";n.IsStat=!0,o.push(n)}let i,a=G("Symbol","="),l=[_(e,t)],s=[];for(;","==F().Source;)s.push(C()),l.push(_(e,t));return i=B({Type:"AssignmentStat",Rhs:l,Lhs:o,Token_Equals:a,Token_LhsSeperatorList:r,Token_RhsSeperatorList:s,GetFirstToken:()=>i.Lhs[0].GetFirstToken(),GetLastToken:()=>i.Rhs[i.Rhs.length-1].GetLastToken()}),i}}function W(e,t){let n=C(),o=_(e,t),r=G("Keyword","then"),i=E(e,t),a=[];for(;"elseif"==F().Source||"else"==F().Source;){let n,o,r=C();"elseif"==r.Source&&(n=_(e,t),o=G("Keyword","then"));let i=E(e,t);if(a.push({Condition:n,Body:i,ClauseType:r.Source,Token:r,Token_Then:o}),"else"==r.Source)break}let l,s=G("Keyword","end");return l=B({Type:"IfStat",Condition:o,Body:i,ElseClauseList:a,Token_If:n,Token_Then:r,Token_End:s,GetFirstToken:()=>l.Token_If,GetLastToken:()=>l.Token_End}),l}function U(e,t){let n,o=C(),[r,i]=I("end",e,t);return n=B({Type:"DoStat",Body:r,Token_Do:o,Token_End:i,GetFirstToken:()=>n.Token_Do,GetLastToken:()=>n.Token_End}),n}function D(e,t){let n,o=C(),r=_(e,t),i=G("Keyword","do"),[a,l]=I("end",e,t);return n=B({Type:"WhileStat",Condition:r,Body:a,Token_While:o,Token_Do:i,Token_End:l,GetFirstToken:()=>n.Token_While,GetLastToken:()=>n.Token_End}),n}function q(e,t){let n=C(),[o,r]=A();if("="==F().Source){let i=C(),[a,l]=R(e,t);if(a.length<2||a.length>3)throw"Expected 2 or 3 values for range bounds";let s,u=G("Keyword","do"),[T,p]=I("end",e,t);return s=B({Type:"NumericForStat",VarList:o,RangeList:a,Body:T,Token_For:n,Token_VarCommaList:r,Token_Equals:i,Token_RangeCommaList:l,Token_Do:u,Token_End:p,GetFirstToken:()=>s.Token_For,GetLastToken:()=>s.Token_End}),s}if("in"==F().Source){let i,a=C(),[l,s]=R(e,t),u=G("Keyword","do"),[T,p]=I("end",e,t);return i=B({Type:"GenericForStat",VarList:o,GeneratorList:l,Body:T,Token_For:n,Token_VarCommaList:r,Token_In:a,Token_GeneratorCommaList:s,Token_Do:u,Token_End:p,GetFirstToken:()=>i.Token_For,GetLastToken:()=>i.Token_End}),i}}function M(e,t){let n,o=C(),[r,i]=I("until",e),a=_(e,t);return n=B({Type:"RepeatStat",Body:r,Condition:a,Token_Repeat:o,Token_Until:i,GetFirstToken:()=>n.Token_Repeat,GetLastToken:()=>n.Condition.GetLastToken()}),n}function K(e,t){let n=C();if("function"==F().Source){let o,r=N(!1,e,t);if(r.NameChain.length>1)throw x(r.Token_NameChainSeperator[0])+": `(` expected.";return o=B({Type:"LocalFunctionStat",FunctionStat:r,Token_Local:n,GetFirstToken:()=>o.Token_Local,GetLastToken:()=>o.FunctionStat.GetLastToken()}),o}if("Ident"==F().Type||"Keyword"==F().Type&&L.includes(F().Source)){let o,r,[i,a]=A(!1,!0),l=[],s=[];if("="==F().Source){o=C();let[n,r]=R(e,t);l=n,s=r}return r=B({Type:"LocalVarStat",VarList:i,ExprList:l,Token_Local:n,Token_Equals:o,Token_VarCommaList:a,Token_ExprCommaList:s,GetFirstToken:()=>r.Token_Local,GetLastToken:function(){return r.ExprList.length>0?r.ExprList[r.ExprList.length-1].GetLastToken():r.VarList[r.VarList.length-1]}}),r}throw"`function` or ident expected"}function H(e,t){let n,o,r,i=C();return b()||";"==F().Source?(n=[],o=[]):[n,o]=R(e,t),r={Type:"ReturnStat",ExprList:n,Token_Return:i,Token_CommaList:o,GetFirstToken:()=>r.Token_Return,GetLastToken:function(){return r.ExprList.length>0?r.ExprList[r.ExprList.length-1].GetLastToken():r.Token_Return}},r}function j(e,t){let n,o=C();return n={Type:"BreakStat",Token_Break:o,GetFirstToken:()=>n.Token_Break,GetLastToken:()=>n.Token_Break},n}function z(){let e,t,n=C();return e="Keyword"==F().Type?G("Keyword"):G("Ident"),t={Type:"GotoStat",Token_Goto:n,Token_Label:e,GetFirstToken:()=>t.Token_Goto,GetLastToken:()=>t.Token_Label},t}function Z(){let e,t=C();e="Keyword"==F().Type?G("Keyword"):G("Ident");let n,o=G("Symbol","::");return n={Type:"LabelStat",Token_ColonsLeft:t,Token_Label:e,Token_ColonsRight:o,GetFirstToken:()=>n.Token_ColonsLeft,GetLastToken:()=>n.Token_ColonsRight},n}function J(e,t){let n=F();return"if"==n.Source?[!1,W(e,t)]:"while"==n.Source?[!1,D(e,t)]:"do"==n.Source?[!1,U(e,t)]:"for"==n.Source?[!1,q(e,t)]:"repeat"==n.Source?[!1,M(e,t)]:"function"==n.Source?[!1,N(!1,e,t)]:"local"==n.Source?[!1,K(e,t)]:"return"==n.Source?[!0,H(e,t)]:"break"==n.Source?[!0,j()]:"continue"==n.Source?function(e,t){if("("==F(1).Source)return[!1,v(e,t)];let n,o=C();return n={Type:"ContinueStat",Token_Continue:o,GetFirstToken:()=>n.Token_Continue,GetLastToken:()=>n.Token_Continue},[!0,n]}(e,t):"goto"==n.Source?[!1,z()]:"::"==n.Source?[!1,Z()]:[!1,v(e,t)]}return _=(e,t)=>O(0,e,t),E=function(t,n){let o,r=[],i=[],a={},l={};if(null!=n)for(let[e,T]of Object.entries(n))l[e]=T;if(null!=t)for(let[e,T]of Object.entries(t))l[e]=T;let s,u=0;for(;!b();){o&&o==F()&&e(`INFINITE LOOP POSSIBLE ON STATEMENT ${o.Source} :`,o),o=F();let[t,n]=J(a,l);if(n)switch(r.push(n),n.Type){case"LocalVarStat":n.VarList.forEach((e=>{e.UseCount=0,e.Number=u++,a[e.Source]=e;let t=[];function n(){e.UseCount++,t.forEach((t=>{t.UseCount=e.UseCount}))}e.Tokens={},e.Tokens.push=o=>{o.UseCountIncrease=n,o.UseCount=e.UseCount,o.Tokens=e.Tokens,t.push(o)},e.Tokens.get=()=>t,e.UseCountIncrease=n}));break;case"LocalFunctionStat":let e=n.FunctionStat.NameChain;if(1===e.length){let t=function(){n.UseCount++,o.forEach((e=>{e.UseCount=n.UseCount}))},n=e[0];n.UseCount=0,n.Number=u++,a[n.Source]=n;let o=[];n.Tokens={},n.Tokens.push=e=>{e.UseCountIncrease=t,e.UseCount=n.UseCount,e.Tokens=n.Tokens,o.push(e)},n.Tokens.get=()=>o,n.UseCountIncrease=t}}let s=F();"Symbol"==s.Type&&";"==s.Source&&(i[r.length-1]=C())}return s={Type:"StatList",StatementList:r,SemicolonList:i,GetFirstToken:function(){var e;return 0==s.StatementList.length||null==(e=s.StatementList[0])?void 0:e.GetFirstToken()},GetLastToken:function(){return 0==s.StatementList.length?void 0:s.SemicolonList[s.StatementList.length-1]?s.SemicolonList[s.StatementList.length-1]:s.StatementList[s.StatementList.length-1].GetLastToken()}},s},E([],[])}function _(e,t){let n,o,r={BinopExpr:!0,UnopExpr:!0,NumberLiteral:!0,StringLiteral:!0,NilLiteral:!0,BooleanLiteral:!0,VargLiteral:!0,HashLiteral:!0,FieldExpr:!0,IndexExpr:!0,MethodExpr:!0,CallExpr:!0,FunctionLiteral:!0,VariableExpr:!0,ParenExpr:!0,TableLiteral:!0},i={StatList:!0,BreakStat:!0,ContinueStat:!0,LabelStat:!0,GotoStat:!0,ReturnStat:!0,LocalVarStat:!0,LocalFunctionStat:!0,FunctionStat:!0,RepeatStat:!0,GenericForStat:!0,NumericForStat:!0,WhileStat:!0,DoStat:!0,IfStat:!0,CallExprStat:!0,AssignmentStat:!0,CompoundStat:!0};for(var[a,l]of Object.entries(t))if(!i[a]&&!r[a])throw`Invalid visitor target: \`${a}\``;function s(e){if(null!=e){let n=t[e.Type];if("function"==typeof n)return n(e);if(n&&n.Pre)return n.Pre(e)}}function u(e){let n=t[e.Type];if(n&&"object"==typeof n&&n.Post)return n.Post(e)}n=function(e){if(!s(e)){if("BinopExpr"==e.Type)n(e.Lhs),n(e.Rhs);else if("UnopExpr"==e.Type)n(e.Rhs);else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type);else if("FieldExpr"==e.Type)n(e.Base);else if("IndexExpr"==e.Type)n(e.Base),n(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)n(e.Base),"ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach(((e,t)=>{n(e)})):"TableCall"==e.FunctionArguments.CallType&&n(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)o(e.Body);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type)n(e.Expression);else if("TableLiteral"==e.Type)e.EntryList.forEach(((e,t)=>{if("Field"==e.EntryType)n(e.Value);else if("Index"==e.EntryType)n(e.Index),n(e.Value);else{if("Value"!=e.EntryType)throw"unreachable";n(e.Value)}}));else{if("CompoundStat"!=e.Type)throw`unreachable, type: ${e.Type}: ${e}`;n(e.Lhs),n(e.Rhs)}u(e)}},o=function(e){if(!s(e)){if("StatList"==e.Type)e.StatementList.forEach(((t,n)=>{if(null!=t){if(null===t||null===t.Type)return;t.Remove=()=>{e.StatementList[n]=null},o(t)}}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("GotoStat"==e.Type);else if("LabelStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach(((e,t)=>{n(e)}));else if("LocalVarStat"==e.Type)e.Token_Equals&&e.ExprList.forEach(((e,t)=>{n(e)}));else if("LocalFunctionStat"==e.Type)o(e.FunctionStat.Body);else if("FunctionStat"==e.Type)o(e.Body);else if("RepeatStat"==e.Type)o(e.Body),n(e.Condition);else if("GenericForStat"==e.Type)e.GeneratorList.forEach(((e,t)=>{n(e)})),o(e.Body);else if("NumericForStat"==e.Type)e.RangeList.forEach(((e,t)=>{n(e)})),o(e.Body);else if("WhileStat"==e.Type)n(e.Condition),o(e.Body);else if("DoStat"==e.Type)o(e.Body);else if("IfStat"==e.Type)n(e.Condition),o(e.Body),e.ElseClauseList.forEach((e=>{null!=e.Condition&&n(e.Condition),o(e.Body)}));else if("CallExprStat"==e.Type)n(e.Expression);else if("CompoundStat"==e.Type)n(e.Lhs),n(e.Rhs);else{if("AssignmentStat"!=e.Type)throw"Unreachable code. Got "+e.Type;e.Lhs.forEach((e=>{n(e)})),e.Rhs.forEach((e=>{n(e)}))}u(e)}},i[e.Type]?o(e):n(e)}function m(e){let n,o=[],r=0;function i(){return r++,r}function a(){n={ParentScope:n,ChildScopeList:[],VariableList:[],BeginLocation:i(),Depth:null,GetVar:null},n.ParentScope?(n.Depth=n.ParentScope.Depth+1,n.ParentScope.ChildScopeList.push(n)):n.Depth=1;let e=n;n.GetVar=function(t){for(const n of e.VariableList)if(n.Name==t)return n;if(e.ParentScope)return e.ParentScope.GetVar(t);for(const e of o)if(e.Name==t)return e}}function l(){let e=n;return e.EndLocation=i(),e.VariableList.forEach((t=>{t.ScopeEndLocation=e.EndLocation})),n=e.ParentScope,e}function s(e,o,r){t(r,"MIssing localInfo"),t(e,"Missing local var name");let a={Type:"Local",Name:e,RenameList:[o],AssignedTo:!1,Info:r,Scope:n,BeginLocation:i(),EndLocation:i(),ReferenceLocationList:[i()],Rename:function(e){a.Name=e,a.RenameList.forEach((t=>{t(e)}))}};return n.VariableList.push(a),a}function u(e,n){t(e,"Missing var name");let r=function(e){for(const n of o)if(n.Name==e)return n;let t={Type:"Global",Name:e,RenameList:[],AssignedTo:!1,Scope:null,BeginLocation:i(),EndLocation:i(),ReferenceLocationList:[],Rename:function(e){t.Name=e,t.RenameList.forEach((t=>{t(e)}))}};return o.push(t),t}(e);return r.RenameList.push(n),r}function T(e,t){let n;for(n=e.VariableList.length-1;n>=0;n--)if(e.VariableList[n].Name==t)return e.VariableList[n];if(e.ParentScope){let n=T(e.ParentScope,t);if(n)return n}}function p(e,o){t(e,"Missing var name");let r=T(n,e);r?r.RenameList.push(o):r=u(e,o);let a=i();return r.EndLocation=a,r.ReferenceLocationList.push(r.EndLocation),r}a();let c={};return c.FunctionLiteral={Pre:function(e){a(),e.ArgList.forEach(((e,t)=>{let n=s(e.Source,(function(t,n){n||(e.Source=t)}),{Type:"Argument",Index:t});e.var=n}))},Post:function(e){l()}},c.VariableExpr=function(e){e.Variable=p(e.Token.Source,(function(t,n=!1){n&&e.IsStat||(e.Token.Source=t)}))},c.StatList={Pre:function(e){a()},Post:function(e){e.SkipPop||l()}},c.LocalVarStat={Post:function(e){e.VarList.forEach(((t,n)=>{s(t.Source,(function(t){e.VarList[n].Source=t}),{Type:"Local"})}))}},c.LocalFunctionStat={Pre:function(e){s(e.FunctionStat.NameChain[0].Source,(function(t){e.FunctionStat.NameChain[0].Source=t}),{Type:"LocalFunction"}),a(),e.FunctionStat.ArgList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"Argument",Index:t})}))},Post:function(){l()}},c.FunctionStat={Pre:function(e){let t,o=e.NameChain;t=1==o.length?T(n,o[0].Source)?p(o[0].Source,(function(e){o[0].Source=e})):u(o[0].Source,(function(e){o[0].Source=e})):p(o[0].Source,(function(e){o[0].Source=e})),t.AssignedTo=!0,a(),e.ArgList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"Argument",Index:t})}))},Post:function(){l()}},c.GenericForStat={Pre:function(e){return e.GeneratorList.forEach((e=>{_(e,c)})),a(),e.VarList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"ForRange",Index:t})})),_(e.Body,c),l(),!0}},c.NumericForStat={Pre:function(e){return e.RangeList.forEach((e=>{_(e,c)})),a(),e.VarList.forEach(((e,t)=>{s(e.Source,(function(t){e.Source=t}),{Type:"ForRange",Index:t})})),_(e.Body,c),l(),!0}},c.RepeatStat={Pre:function(e){e.Body.SkipPop=!0},Post:function(e){l()}},c.AssignmentStat={Post:function(e){e.Lhs.forEach((e=>{null!=e.Variable&&(e.Variable.AssignedTo=!0)}))}},_(e,c),[o,l()]}function g(e){let n,o,r="";function i(e){if(null==e.LeadingWhite||null==e.Source)throw`Bad token: tk=${e} | lwhite=${e.LeadingWhite} | source=${e.Source}`;r=`${r}${e.LeadingWhite}${e.Source}`}return o=function(e){if("BinopExpr"==e.Type)o(e.Lhs),i(e.Token_Op),o(e.Rhs);else if("UnopExpr"==e.Type)i(e.Token_Op),o(e.Rhs);else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type)i(e.Token);else if("FieldExpr"==e.Type)o(e.Base),i(e.Token_Dot),i(e.Field);else if("IndexExpr"==e.Type)o(e.Base),i(e.Token_OpenBracket),o(e.Index),i(e.Token_CloseBracket);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)o(e.Base),"MethodExpr"==e.Type&&(i(e.Token_Colon),i(e.Method)),"StringCall"==e.FunctionArguments.CallType?i(e.FunctionArguments.Token):"ArgCall"==e.FunctionArguments.CallType?(i(e.FunctionArguments.Token_OpenParen),e.FunctionArguments.ArgList.forEach(((t,n)=>{o(t);let r=e.FunctionArguments.Token_CommaList[n];null!=r&&i(r)})),i(e.FunctionArguments.Token_CloseParen)):"TableCall"==e.FunctionArguments.CallType&&o(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)i(e.Token_Function),i(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{i(t);let o=e.Token_ArgCommaList[n];null!=o&&i(o)})),null!=e.Token_Varg&&i(e.Token_Varg),i(e.Token_CloseParen),n(e.Body),i(e.Token_End);else if("VariableExpr"==e.Type)i(e.Token);else if("ParenExpr"==e.Type)i(e.Token_OpenParen),o(e.Expression),i(e.Token_CloseParen);else if("TableLiteral"==e.Type)i(e.Token_OpenBrace),e.EntryList.forEach(((t,n)=>{if("Field"==t.EntryType)i(t.Field),i(t.Token_Equals),o(t.Value);else if("Index"==t.EntryType)i(t.Token_OpenBracket),o(t.Index),i(t.Token_CloseBracket),i(t.Token_Equals),o(t.Value);else{if("Value"!=t.EntryType)throw"unreachable";o(t.Value)}let r=e.Token_SeperatorList[n];null!=r&&i(r)})),i(e.Token_CloseBrace);else{if("CompoundStat"!=e.Type)throw`unreachable, type: ${e.Type}: ${e}`;n(e)}},n=function(e){if(null==e)throw`STAT IS NIL! ${e}`;if("StatList"!==e.Type||0!==e.StatementList.length){if(e.WrapInDo){let t="string"!=typeof(null==(a=e.GetFirstToken())?void 0:a.LeadingWhite)?" ":a.LeadingWhite;e.GetFirstToken().LeadingWhite="",r+=`${t}do `}var a;"StatList"==e.Type?e.StatementList.forEach(((t,o)=>{null!==t&&null!==t.Type&&(t.Remove=()=>{e.StatementList[o]=null},n(t),e.SemicolonList[o]&&i(e.SemicolonList[o]))})):"BreakStat"==e.Type?i(e.Token_Break):"ContinueStat"==e.Type?i(e.Token_Continue):"GotoStat"==e.Type?(i(e.Token_Goto),i(e.Token_Label)):"LabelStat"==e.Type?(i(e.Token_ColonsLeft),i(e.Token_Label),i(e.Token_ColonsRight)):"ReturnStat"==e.Type?(i(e.Token_Return),e.ExprList.forEach(((t,n)=>{o(t),e.Token_CommaList[n]&&i(e.Token_CommaList[n])}))):"LocalVarStat"==e.Type?(i(e.Token_Local),e.VarList.forEach(((t,n)=>{i(t),null!=t.Attribute&&i(t.Attribute);let o=e.Token_VarCommaList[n];null!=o&&i(o)})),null!=e.Token_Equals&&(i(e.Token_Equals),e.ExprList.forEach(((t,n)=>{o(t);let r=e.Token_ExprCommaList[n];null!=r&&i(r)})))):"LocalFunctionStat"==e.Type?(i(e.Token_Local),i(e.FunctionStat.Token_Function),i(e.FunctionStat.NameChain[0]),i(e.FunctionStat.Token_OpenParen),e.FunctionStat.ArgList.forEach(((t,n)=>{i(t);let o=e.FunctionStat.Token_ArgCommaList[n];null!=o&&i(o)})),e.FunctionStat.Token_Varg&&i(e.FunctionStat.Token_Varg),i(e.FunctionStat.Token_CloseParen),n(e.FunctionStat.Body),i(e.FunctionStat.Token_End)):"FunctionStat"==e.Type?(i(e.Token_Function),e.NameChain.forEach(((t,n)=>{i(t);let o=e.Token_NameChainSeperator[n];null!=o&&i(o)})),i(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{i(t);let o=e.Token_ArgCommaList[n];null!=o&&i(o)})),e.Token_Varg&&i(e.Token_Varg),i(e.Token_CloseParen),n(e.Body),i(e.Token_End)):"RepeatStat"==e.Type?(i(e.Token_Repeat),n(e.Body),i(e.Token_Until),o(e.Condition)):"GenericForStat"==e.Type?(i(e.Token_For),e.VarList.forEach(((t,n)=>{i(t);let o=e.Token_VarCommaList[n];null!=o&&i(o)})),i(e.Token_In),e.GeneratorList.forEach(((t,n)=>{o(t);let r=e.Token_GeneratorCommaList[n];null!=r&&i(r)})),i(e.Token_Do),n(e.Body),i(e.Token_End)):"NumericForStat"==e.Type?(i(e.Token_For),e.VarList.forEach(((t,n)=>{i(t);let o=e.Token_VarCommaList[n];null!=o&&i(o)})),i(e.Token_Equals),e.RangeList.forEach(((t,n)=>{o(t);let r=e.Token_RangeCommaList[n];null!=r&&i(r)})),i(e.Token_Do),n(e.Body),i(e.Token_End)):"WhileStat"==e.Type?(i(e.Token_While),o(e.Condition),i(e.Token_Do),n(e.Body),i(e.Token_End)):"DoStat"==e.Type?(i(e.Token_Do),n(e.Body),i(e.Token_End)):"IfStat"==e.Type?(i(e.Token_If),o(e.Condition),i(e.Token_Then),n(e.Body),e.ElseClauseList.forEach((e=>{i(e.Token),null!=e.Condition&&(o(e.Condition),i(e.Token_Then)),n(e.Body)})),i(e.Token_End)):"CallExprStat"==e.Type?o(e.Expression):"CompoundStat"==e.Type?(o(e.Lhs),i(e.Token_Compound),o(e.Rhs),e.Type="CompoundStat"):"AssignmentStat"==e.Type?(e.Lhs.forEach(((t,n)=>{o(t);let r=e.Token_LhsSeperatorList[n];null!=r&&i(r)})),i(e.Token_Equals),e.Rhs.forEach(((t,n)=>{o(t);let r=e.Token_RhsSeperatorList[n];null!=r&&i(r)}))):t(!1,"unreachable"),e.WrapInDo&&(r+=" end ")}},n(e),r}function C(e){let n,o;function r(e){e&&(e.LeadingWhite="")}function i(e,t,n=!1){r(t);let o=("string"==typeof e.Source?e.Source:e.Source.toString()).substr(e.Source.length-1,1),i=("string"==typeof t.Source?t.Source:t.Source.toString()).substr(0,1);"-"==o&&"-"==i||a.includes(o)&&a.includes(i)||n&&")"==o&&"("==i?t.LeadingWhite=n?";":" ":t.LeadingWhite=""}function l(e,t,o){n(t),r(o);let a=t.GetFirstToken(),l=t.GetLastToken();null!=a?(i(e,a),i(l,o)):i(e,o)}o=function(e){if("BinopExpr"===e.Type)o(e.Lhs),o(e.Rhs),"NumberLiteral"==e.Lhs.Type&&".."==e.Token_Op.Source?e.Token_Op.LeadingWhite=" ":(r(e.Token_Op),i(e.Lhs.GetLastToken(),e.Token_Op)),i(e.Token_Op,e.Rhs.GetFirstToken());else if("UnopExpr"===e.Type)r(e.Token_Op),o(e.Rhs),i(e.Token_Op,e.Rhs.GetFirstToken());else if("NumberLiteral"===e.Type||"StringLiteral"===e.Type||"NilLiteral"===e.Type||"BooleanLiteral"===e.Type||"VargLiteral"===e.Type||"HashLiteral"===e.Type)r(e.Token);else if("FieldExpr"==e.Type)o(e.Base),r(e.Token_Dot),r(e.Field);else if("IndexExpr"==e.Type)o(e.Base),r(e.Token_OpenBracket),o(e.Index),r(e.Token_CloseBracket);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)o(e.Base),"MethodExpr"==e.Type&&(r(e.Token_Colon),r(e.Method)),"StringCall"==e.FunctionArguments.CallType?r(e.FunctionArguments.Token):"ArgCall"==e.FunctionArguments.CallType?(r(e.FunctionArguments.Token_OpenParen),e.FunctionArguments.ArgList.forEach(((t,n)=>{o(t);let i=e.FunctionArguments.Token_CommaList[n];null!=i&&r(i)})),r(e.FunctionArguments.Token_CloseParen)):"TableCall"==e.FunctionArguments.CallType&&o(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)r(e.Token_Function),r(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{r(t);let o=e.Token_ArgCommaList[n];null!=o&&r(o)})),null!=e.Token_Varg&&r(e.Token_Varg),r(e.Token_CloseParen),l(e.Token_CloseParen,e.Body,e.Token_End);else if("VariableExpr"==e.Type)r(e.Token);else if("ParenExpr"==e.Type)r(e.Token_OpenParen),o(e.Expression),r(e.Token_CloseParen);else{if("TableLiteral"!=e.Type)throw`unreachable, type: ${e.Type}:${e}  ${console.trace()}`;r(e.Token_OpenBrace),e.EntryList.forEach(((n,i)=>{"Field"==n.EntryType?(r(n.Field),r(n.Token_Equals),o(n.Value)):"Index"==n.EntryType?(r(n.Token_OpenBracket),o(n.Index),r(n.Token_CloseBracket),r(n.Token_Equals),o(n.Value)):"Value"==n.EntryType?o(n.Value):t(!1,"unreachable");let a=e.Token_SeperatorList[i];null!=a&&r(a)})),e.Token_SeperatorList[e.EntryList.length-1]=null,r(e.Token_CloseBrace)}},n=function(e){if("StatList"==e.Type){let t;for(t=0;t<=e.StatementList.length;t++){let o=e.StatementList[t];if(null==o)continue;n(o),r(o.GetFirstToken());let a=e.StatementList[t-1];if(null!=a){let n={")":["(","["],"]":["(","["]};if(e.SemicolonList[t-1]){let r=a.GetLastToken().Source,i=o.GetFirstToken().Source;null!==n[r]&&void 0!==n[r]&&n[r].includes(i)||(e.SemicolonList[t-1]=null)}e.SemicolonList[t-1]||i(a.GetLastToken(),o.GetFirstToken(),!0)}}e.SemicolonList[e.StatementList.length-1]=null,e.StatementList.length>0&&r(e.StatementList[0].GetFirstToken())}else if("BreakStat"==e.Type)r(e.Token_Break);else if("ContinueStat"==e.Type)r(e.Token_Continue);else if("GotoStat"==e.Type)r(e.Token_Goto),i(e.Token_Goto,e.Token_Label);else if("LabelStat"==e.Type)r(e.Token_ColonsLeft),r(e.Token_Label),r(e.Token_ColonsRight);else if("ReturnStat"==e.Type)r(e.Token_Return),e.ExprList.forEach(((t,n)=>{o(t),null!=e.Token_CommaList[n]&&r(e.Token_CommaList[n])})),e.ExprList.length>0&&i(e.Token_Return,e.ExprList[0].GetFirstToken());else if("LocalVarStat"==e.Type){r(e.Token_Local);let t=!1;e.VarList.forEach(((n,o)=>{0==o?i(e.Token_Local,n):r(n),n.Attribute&&(r(n.Attribute),o+1==e.VarList.length&&(t=!0));let a=e.Token_VarCommaList[o];null!=a&&r(a)})),null!=e.Token_Equals&&(t||r(e.Token_Equals),e.ExprList.forEach(((t,n)=>{o(t);let i=e.Token_ExprCommaList[n];null!=i&&r(i)})))}else if("LocalFunctionStat"==e.Type)r(e.Token_Local),i(e.Token_Local,e.FunctionStat.Token_Function),i(e.FunctionStat.Token_Function,e.FunctionStat.NameChain[0]),i(e.FunctionStat.NameChain[0],e.FunctionStat.Token_OpenParen),e.FunctionStat.ArgList.forEach(((t,n)=>{r(t);let o=e.FunctionStat.Token_ArgCommaList[n];null!=o&&r(o)})),e.FunctionStat.Token_Varg&&r(e.FunctionStat.Token_Varg),r(e.FunctionStat.Token_CloseParen),l(e.FunctionStat.Token_CloseParen,e.FunctionStat.Body,e.FunctionStat.Token_End);else if("FunctionStat"==e.Type)r(e.Token_Function),e.NameChain.forEach(((t,n)=>{0==n?i(e.Token_Function,t):r(t);let o=e.Token_NameChainSeperator[n];null!=o&&r(o)})),r(e.Token_OpenParen),e.ArgList.forEach(((t,n)=>{r(t);let o=e.Token_ArgCommaList[n];null!=o&&r(o)})),e.Token_Varg&&r(e.Token_Varg),r(e.Token_CloseParen),l(e.Token_CloseParen,e.Body,e.Token_End);else if("RepeatStat"==e.Type)r(e.Token_Repeat),l(e.Token_Repeat,e.Body,e.Token_Until),o(e.Condition),i(e.Token_Until,e.Condition.GetFirstToken());else if("GenericForStat"==e.Type)r(e.Token_For),e.VarList.forEach(((t,n)=>{0==n?i(e.Token_For,t):r(t);let o=e.Token_VarCommaList[n];null!=o&&r(o)})),i(e.VarList[e.VarList.length-1],e.Token_In),e.GeneratorList.forEach(((t,n)=>{o(t),0==n&&i(e.Token_In,t.GetFirstToken());let a=e.Token_GeneratorCommaList[n];null!=a&&r(a)})),i(e.GeneratorList[e.GeneratorList.length-1].GetLastToken(),e.Token_Do),l(e.Token_Do,e.Body,e.Token_End);else if("NumericForStat"==e.Type)r(e.Token_For),e.VarList.forEach(((t,n)=>{0==n?i(e.Token_For,t):r(t);let o=e.Token_VarCommaList[n];null!=o&&r(o)})),i(e.VarList[e.VarList.length-1],e.Token_Equals),e.RangeList.forEach(((t,n)=>{o(t),0==n&&i(e.Token_Equals,t.GetFirstToken());let a=e.Token_RangeCommaList[n];null!=a&&r(a)})),i(e.RangeList[e.RangeList.length-1].GetLastToken(),e.Token_Do),l(e.Token_Do,e.Body,e.Token_End);else if("WhileStat"==e.Type)r(e.Token_While),o(e.Condition),r(e.Token_Do),i(e.Token_While,e.Condition.GetFirstToken()),i(e.Condition.GetLastToken(),e.Token_Do),l(e.Token_Do,e.Body,e.Token_End);else if("DoStat"==e.Type)r(e.Token_Do),r(e.Token_End),l(e.Token_Do,e.Body,e.Token_End);else if("IfStat"==e.Type){r(e.Token_If),o(e.Condition),i(e.Token_If,e.Condition.GetFirstToken()),i(e.Condition.GetLastToken(),e.Token_Then);let t=e.Token_Then,a=e.Body;e.ElseClauseList.forEach(((e,r)=>{l(t,a,e.Token),t=e.Token,null!=e.Condition&&(o(e.Condition),i(e.Token,e.Condition.GetFirstToken()),i(e.Condition.GetLastToken(),e.Token_Then),t=e.Token_Then),n(e.Body),a=e.Body})),l(t,a,e.Token_End)}else if("CallExprStat"==e.Type)o(e.Expression);else if("CompoundStat"==e.Type)o(e.Lhs),r(e.Token_Compound),o(e.Rhs),i(e.Lhs.GetLastToken(),e.Token_Compound),i(e.Token_Compound,e.Rhs.GetFirstToken());else{if("AssignmentStat"!=e.Type)return o(e);e.Lhs.forEach(((t,n)=>{o(t);let i=e.Token_LhsSeperatorList[n];null!=i&&r(i)})),r(e.Token_Equals),e.Rhs.forEach(((t,n)=>{o(t);let i=e.Token_RhsSeperatorList[n];null!=i&&r(i)}))}},n(e)}function F(e){let o,r,i={NumberLiteral:!0,BooleanLiteral:!0,StringLiteral:!0,HashLiteral:!0,NilLiteral:!0,TableLiteral:!0,ParenExpr:!0,BinopExpr:!0};function a(e,t,n=null){let o;return o={Type:e,Token:{Type:null==n?"Number":n,LeadingWhite:"",Source:t},GetFirstToken:()=>o.Token,GetLastToken:()=>o.Token},o}function l(e,t){let n;return n={Type:"UnopExpr",Token_Op:{Type:"Symbol",LeadingWhite:"",Source:e},Rhs:t,GetFirstToken:()=>n.Token_Op,GetLastToken:()=>n.Rhs.GetLastToken()},n}function s(e,t){if(null!=t)for(var[n,o]of Object.entries(t))e[n]=o}function u(e){if(null==e||null==e.substr)return;let t,n=e.substr(0,1);if('"'!=n&&"'"!=n||(t=e.substr(1,e.length-2)),"["==n){let n=0,o=1;for(;"="==e.substr(o,1);)n++,o++;t=e.substr(2+n,e.length-4-n-2)}if(null==t)return"";let o,r="";for(o=0;o<=t.length;o++){let e=t.substr(o,1);r+="'"==e||'"'==e?`\\${e}`:e}return r}function T(e){if("object"==typeof e&&"ParenExpr"==e.Type)return s(e,e.Expression)}r=function(e){if("BinopExpr"==e.Type){if(r(e.Lhs),r(e.Rhs),null!=e.Lhs&&null!=e.Rhs){let t=e.Token_Op;if(null!=t&&null!=t.Source){let o=function(e,t,o){let r=t,i=o;if(t&&"ParenExpr"==t.Type&&(r=t.Expression),o&&"ParenExpr"==o.Type&&(i=o.Expression),null==r||null==i||null==r.Type||null==i.Type)return;if("VariableExpr"==r.Type||"CallExpr"==r.Type||"BinopExpr"==r.Type||"CallExpr"==i.Type||"BinopExpr"==i.Type||"VariableExpr"==i.Type)return;let a,l,s=r.Token||null!=r.Expression&&r.Expression.Token||null,T=i.Token||null!=i.Expression&&i.Expression.Token||null,p=null!=s?s.Source:null,c=null!=T?T.Source:null;if("BooleanLiteral"==r.Type&&(a="true"==p),"BooleanLiteral"==i.Type&&(l="true"==c),!("NumberLiteral"==r.Type&&(a=n(p),null==a)||"NumberLiteral"==i.Type&&(l=n(c),null==l)||("StringLiteral"!=r.Type&&"HashLiteral"!=r.Type||(a=p.toString()),"StringLiteral"!=i.Type&&"HashLiteral"!=i.Type||(l=c.toString()),null==a||null==l))){if("=="==e)return a==l;if("~="==e)return a!=l;if("and"==e)return a&&l;if("or"==e)return a||l;if(".."==e&&"StringLiteral"==r.Type&&"StringLiteral"==i.Type)return`"${u(p)+u(c)}"`;if("StringLiteral"==r.Type&&(a=n(u(a))),"StringLiteral"==i.Type&&(l=n(u(l))),null==a||null==l)return;let t;if("+"==e&&(t=a+l),"-"==e&&(t=a-l),"*"==e&&(t=a*l),"/"==e&&(t=a/l),"^"==e&&(t=a**l),"%"==e&&(t=a%l),">"==e&&(t=a>l),"<"==e&&(t=a<l),">="==e&&(t=a>=l),"<="==e&&(t=a<=l),0==t||1==t||isFinite(t)&&t>-1e6&&t<10**6)return t}}(t.Source,e.Lhs,e.Rhs);if(null!=o){if("boolean"==typeof o){return void s(e,a("BooleanLiteral",o.toString(),"Keyword"))}if("number"==typeof o){if(1==isFinite(o)){return void s(e,a("NumberLiteral",o.toString(),"Number"))}}else{if("string"==typeof o){return void s(e,a("StringLiteral",o,"String"))}if("object"==typeof o)return void s(e,o)}return}}if("ParenExpr"==e.Lhs.Type){let t=e.Lhs.Expression;"NumberLiteral"==t.Type||"StringLiteral"==t.Type||"NilLiteral"==t.Type||"BooleanLiteral"==t.Type||t.Type}if("ParenExpr"==e.Rhs.Type){let t=e.Rhs.Expression;"NumberLiteral"==t.Type||"StringLiteral"==t.Type||"NilLiteral"==t.Type||"BooleanLiteral"==t.Type||t.Type}}}else if("UnopExpr"==e.Type){if(r(e.Rhs),null!=e.Rhs&&1==i[e.Rhs.Type]){let t=e.Token_Op;if(null!=t&&null!=t.Source){let o=null!=e.Rhs.Expression?e.Rhs.Expression:e.Rhs,r=function(e,t){let o=t.Token||t.Expression||t.EntryList||t;if(null==o)return;if(null==o.Source&&"TableLiteral"!=t.Type)return;if("VariableExpr"==t.Type||"CallExpr"==t.Type||"BinopExpr"==t.Type)return;let r,i=o.Source;if("TableLiteral"==t.Type&&null!=o){let n=[],r=0,i=!1,s=!1,u=0;if(o.forEach(((e,t)=>{if(i)n.push(e);else if("Value"==e.EntryType||"Index"==e.EntryType)if(null!=e.Index&&"NumberLiteral"!=e.Index.Type||!e.Value)n.push(e);else{if((null!=e.Index&&null!=e.Index.Token&&null!==e.Index.Token.Source?e.Index.Token.Source:u+1).toString()!==(++u).toString())return i=!0,s=!0,n.push(e);"CallExpr"!=e.Value.Type?r++:(i=!0,n.push(e))}})),s)return;if("#"==e){if(t.EntryList=n,t.EntryList.length<=0)return a("NumberLiteral",null!==r?r:t.EntryList.length);if(r<=0)return l("#",t);let e=function(e,t,n){let o;return o={Type:"BinopExpr",Token_Op:{Type:"Symbol",LeadingWhite:"",Source:e},Lhs:t,Rhs:n,GetFirstToken:()=>o.Lhs.GetFirstToken(),GetLastToken:()=>o.Rhs.GetLastToken()},o}("+",a("NumberLiteral",r),l("#",t));return e}}if("BooleanLiteral"==t.Type&&(r="true"==i),"NumberLiteral"!=t.Type||(r=n(i),null!==r)){if("StringLiteral"==t.Type&&(r=i.substr(1,i.length-2)),"not"==e&&null!==t.Type)return"NilLiteral"==t.Type||"BooleanLiteral"==t.Type&&!1===r;if(null!=r){if("#"==e)return r.length;if("-"==e)return-r}}}(t.Source,o);if(null!=r){if("boolean"==typeof r){return void s(e,a("BooleanLiteral",r.toString(),"Keyword"))}if("number"==typeof r){if(1==isFinite(r)){return void s(e,a("NumberLiteral",r,"Number"))}}else{if("string"==typeof r){return void s(e,a("StringLiteral",r,"String"))}if("object"==typeof r)return void s(e,r)}return}}}}else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type){let t=e.Token;if(null!=t){if("Number"==t.Type){let e=t.Source.toString().split("e");if(2===e.length){let o=n(e[0]),r=n(e[1]);isFinite(o)&&isFinite(r)&&o**r<999999999&&!t.Source.includes("+")&&t.Source.includes(".")&&!t.Source.includes("-")&&(t.Source=(o**r).toString())}}"String"==t.Type&&(t.Source=t.Source.replace(/\\\d+/gi,(e=>{let t=n(e.substr(1,e.length-1));return t&&isFinite(t)&&(t>=97&&t<=122||t>=65&&t<=90||t>=33&&t<=47||t>=58&&t<=64||t>=91&&t<=96||t>=123&&t<=126)&&34!==t&&39!==t&&92!==t?String.fromCharCode(t):e})))}}else if("FieldExpr"==e.Type)r(e.Base);else if("IndexExpr"==e.Type)r(e.Base),r(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)r(e.Base),"ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach(((e,t)=>{r(e)})):"TableCall"==e.FunctionArguments.CallType&&r(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)o(e.Body);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type){let t=e.Expression;null!=t&&"ParenExpr"==t.Type&&(e.Expression=t.Expression),r(e.Expression),"NumberLiteral"!=e.Type&&"StringLiteral"!=e.Type&&"NilLiteral"!=e.Type&&"BooleanLiteral"!=e.Type&&"VargLiteral"!=e.Type&&"HashLiteral"!=e.Type||T(e)}else"TableLiteral"==e.Type&&e.EntryList.forEach(((e,n)=>{"Field"==e.EntryType?r(e.Value):"Index"==e.EntryType?(r(e.Index),r(e.Value)):"Value"==e.EntryType?r(e.Value):t(!1,"unreachable")}))},o=function(e){if("StatList"==e.Type)e.StatementList.forEach(((t,n)=>{null!==t&&null!==t.Type&&(t.Remove=()=>{e.StatementList[n]=null},o(t))}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach(((e,t)=>{r(e)}));else if("LocalVarStat"==e.Type)null!=e.Token_Equals&&e.ExprList.forEach(((e,t)=>{r(e)}));else if("LocalFunctionStat"==e.Type)o(e.FunctionStat.Body),1===e.FunctionStat.NameChain.length&&e.FunctionStat.NameChain[0].UseCount;else if("FunctionStat"==e.Type)o(e.Body);else if("RepeatStat"==e.Type)o(e.Body),r(e.Condition),"StatList"==e.Body.Type&&e.Body.StatementList.length;else if("GenericForStat"==e.Type)e.GeneratorList.forEach(((e,t)=>{r(e)})),o(e.Body);else if("NumericForStat"==e.Type){e.RangeList.forEach(((e,t)=>{r(e)})),o(e.Body);let t=e.RangeList[0],i=e.RangeList[1],a=e.RangeList[2];if(null==t||null==i)return e.Remove();if(T(t),T(i),T(a),"NumberLiteral"!=t.Type||"NumberLiteral"!=i.Type||null!=a&&"NumberLiteral"!=a.Type||null==a)return;let l=n(t.Token.Source),s=n(i.Token.Source),u=null!=a&&n(a.Token.Source)||1;if(!((u>0&&l<=s||u<0&&l>=s)&&(s-l+u)/u>=0))return e.Remove();if("StatList"==e.Body.Type&&0===e.Body.StatementList.length)return e.Remove()}else if("WhileStat"==e.Type){r(e.Condition),o(e.Body);let t=e.Condition;switch(t.Type){case"ParenExpr":t=t.Expression;case"BooleanLiteral":if(null==t||null==t.Token||"false"!==t.Token.Source)break;case"NilLiteral":e.Remove()}}else if("DoStat"==e.Type){if(o(e.Body),null===e.Body||"StatList"==e.Body.Type&&0===e.Body.StatementList.length)return e.Remove();if(1===e.Body.StatementList.length){let t=e.Body.StatementList[0];"ContinueStat"!==t.Type&&"BreakStat"!==t.Type&&"ReturnStat"!==t.Type&&s(e,t)}}else if("IfStat"==e.Type){r(e.Condition),o(e.Body),e.ElseClauseList.forEach(((e,t)=>{null!=e.Condition&&r(e.Condition),o(e.Body)}));let t=e.Condition;switch(t.Type){case"ParenExpr":t=t.Expression;case"BooleanLiteral":if(e.ElseClauseList.length>=1||null==t||null==t.Token||"false"!==t.Token.Source)break;case"NilLiteral":e.Remove()}}else"CallExprStat"==e.Type?r(e.Expression):"CompoundStat"==e.Type?(r(e.Lhs),r(e.Rhs)):"AssignmentStat"==e.Type&&(e.Lhs.forEach(((e,t)=>{r(e)})),e.Rhs.forEach(((e,t)=>{r(e)})))},o(e)}let x,b=[];for(x="a".charCodeAt();x<="z".charCodeAt();x++)b.push(String.fromCharCode(x));for(x="A".charCodeAt();x<="Z".charCodeAt();x++)b.push(String.fromCharCode(x));for(x="0".charCodeAt();x<="9".charCodeAt();x++)b.push(String.fromCharCode(x));b.push("_");let G=[];for(x="a".charCodeAt();x<="z".charCodeAt();x++)G.push(String.fromCharCode(x));for(x="A".charCodeAt();x<="Z".charCodeAt();x++)G.push(String.fromCharCode(x));function B(e){let t="",n=e%G.length;for(e=(e-n)/G.length,t=`${t}${G[n]}`;e>0;){let n=e%b.length;e=(e-n)/b.length,t=`${t}${b[n]}`}return t}function R(e,t,n){let o=[];for(var[r,i]of Object.entries(k))o[r]=!0;let a=[];e.forEach((e=>{e.AssignedTo&&n?a.push(e):o[e.Name]=!0})),function e(t){t.VariableList.forEach((e=>{a.push(e)})),t.ChildScopeList.forEach((t=>{e(t)}))}(t),a.forEach((e=>{e.UsedNameArray=[]})),a.sort(((e,t)=>e-t));let l=0,s=[];a.forEach(((e,t)=>{e.Renamed=!0;let n=0;for(;e.UsedNameArray[n];)n++;e.Rename(function(e){let t=s[e];if(null==t){for(t=B(l),l++;o[t];)t=B(l),l++;s[e]=t}return t}(n)),e.Scope?a.forEach((t=>{t.Renamed||(!t.Scope||t.Scope.Depth<e.Scope.Depth?t.ReferenceLocationList.some((o=>o>=e.BeginLocation&&o<=e.ScopeEndLocation&&(t.UsedNameArray[n]=!0,!0))):t.Scope.Depth>e.Scope.Depth?e.ReferenceLocationList.some((e=>e>=t.BeginLocation&&e<=t.ScopeEndLocation&&(t.UsedNameArray[n]=!0,!0))):e.BeginLocation<t.EndLocation&&e.EndLocation>t.BeginLocation&&(t.UsedNameArray[n]=!0))})):a.forEach((t=>{if(!t.Renamed)if("Global"==t.Type)t.UsedNameArray[n]=!0;else{if("Local"!=t.Type)throw"Unreachable";e.ReferenceLocationList.some((e=>e>=t.BeginLocation&&e<=t.ScopeEndLocation&&(t.UsedNameArray[n]=!0,!0)))}}))}))}let V={Minify:function(e,t){let n=E(e),[o,r]=m(n);1==t.RenameVariables&&R(o,r,t.RenameGlobals),1==t.SolveMath&&F(n),C(n);let i=g(n);return i=`${i}`,i}};V.Beautify=function(n,r){let i=E(n),[a,l]=m(i);r.RenameVariables&&function(e,t,n){let o=[];e.forEach((e=>{e.AssignedTo&&n||(o[e.Name]=!0)}));let r=1,i=1;function a(e,t){e.Name=t,e.RenameList.forEach((e=>{e(t)}))}if(n){let t={};e.forEach((e=>{e.AssignedTo&&!e.ChangedName&&(t[e.Name]=t[e.Name]||`G_${i}_`,e.ChangedName=!0,a(e,t[e.Name]),i++)}))}!function e(t){t.VariableList.forEach((e=>{let t=`L_${r}_`;"Argument"==e.Info.Type?t=`${t}arg${e.Info.Index}`:"LocalFunction"==e.Info.Type?t=`${t}func`:"ForRange"==e.Info.Type&&(t=`${t}forvar${e.Info.Index}`),a(e,t),r++})),t.ChildScopeList.forEach((t=>{e(t)}))}(t)}(a,l,r.RenameGlobals),1==r.SolveMath&&F(i),r.Indentation="string"==typeof r.Indentation?r.Indentation:"\t",function(n,r){let i,a,l=0;function s(e){if(void 0===e)return;let t=`\n${r.repeat(l)}`;if(""==e.LeadingWhite||e.LeadingWhite.substr(-t.length,t.length)!=t){let n,o="";for(n=e.LeadingWhite.length;n>=0;n--){let t=e.LeadingWhite.substr(n,1);if(""!=t&&!t.match(/\s/g)){o=e.LeadingWhite.substr(0,n+1);break}}e.LeadingWhite=`${o}${t}`}}function u(){l++}function T(){l--,t(l>=0,"Undented too far")}function p(e){e.LeadingWhite=e.LeadingWhite.trim()}function c(e){p(e),o.includes(function(e){return e.LeadingWhite.length>0?e.LeadingWhite.substr(0,1):e.Source.toString().substr(0,1)}(e))||(e.LeadingWhite=" "+e.LeadingWhite)}function f(e){c(e.GetFirstToken())}function k(e,t,n){u(),i(t),T(),s(n)}a=function(n){if("BinopExpr"==n.Type)a(n.Lhs),a(n.Rhs),f(n.Rhs),c(n.Token_Op);else if("UnopExpr"==n.Type)p(n.Token_Op),a(n.Rhs),n.Token_Op.Source[0]&&c(n.Rhs.GetFirstToken());else if("NumberLiteral"==n.Type||"StringLiteral"==n.Type||"NilLiteral"==n.Type||"BooleanLiteral"==n.Type||"VargLiteral"==n.Type||"HashLiteral"==n.Type)p(n.Token),"HashLiteral"==n.Type&&(n.Token.Source='"'+function(e){for(var t=0,n=e.length;n--;)t+=e.charCodeAt(n),t+=t<<10,t^=t>>6;return t+=t<<3,(t^=t>>11)+(t<<15)}(`${n.Token.Source.substring(1,n.Token.Source.length-1)}`)+'"',n.Type="StringLiteral",n.Token.Type="String");else if("FieldExpr"==n.Type)a(n.Base);else if("IndexExpr"==n.Type)a(n.Base),a(n.Index);else if("MethodExpr"==n.Type||"CallExpr"==n.Type)a(n.Base),p(n.FunctionArguments.GetFirstToken()),p(n.FunctionArguments.GetLastToken()),n.Type,"StringCall"==n.FunctionArguments.CallType||("ArgCall"==n.FunctionArguments.CallType?n.FunctionArguments.ArgList.forEach(((e,t)=>{a(e),t>0&&f(e);let o=n.FunctionArguments.Token_CommaList[t];null!=o&&p(o)})):"TableCall"==n.FunctionArguments.CallType&&a(n.FunctionArguments.TableExpr));else if("FunctionLiteral"==n.Type)n.ArgList.forEach(((e,t)=>{t>0&&c(e),n.Token_ArgCommaList[t]})),n.ArgList.length>0&&null!=n.Token_Varg&&c(n.Token_Varg),k(n.Token_CloseParen,n.Body,n.Token_End);else if("VariableExpr"==n.Type);else if("ParenExpr"==n.Type)p(n.Token_OpenParen),p(n.Token_CloseParen),a(n.Expression);else if("TableLiteral"==n.Type)if(0==n.EntryList.length);else{u();let e=100;n.EntryList.forEach(((o,r)=>{"Field"==o.EntryType?(n.EntryList.length>e?C(o.Value):s(o.Field),c(o.Token_Equals),a(o.Value),f(o.Value)):"Index"==o.EntryType?(n.EntryList.length>e?p(o.Token_OpenBracket):s(o.Token_OpenBracket),a(o.Index),c(o.Token_Equals),a(o.Value),f(o.Value)):"Value"==o.EntryType?(a(o.Value),n.EntryList.length>e?C(o.Value):s(o.Value.GetFirstToken())):t(!1,"unreachable");let i=n.Token_SeperatorList[r];null!=i&&(n.EntryList.length>e?i.LeadingWhite="":p(i))})),T(),n.EntryList.length>e?n.Token_CloseBrace.LeadingWhite="":s(n.Token_CloseBrace)}else{if("CompoundStat"!=n.Type)throw e(n),`unreachable, type: ${n.Type}:`+n;i(n)}},i=function(e){if("StatList"==e.Type)e.StatementList.forEach(((e,t)=>{null!==e&&null!==e.Type&&("StatList"===e.Type&&0===e.StatementList.length||(e.Remove=()=>{e.StatementList[t]=null},i(e),s(e.GetFirstToken())))}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("GotoStat"==e.Type);else if("LabelStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach(((t,n)=>{a(t),f(t),e.Token_CommaList[n]}));else if("LocalVarStat"==e.Type){if(e.VarList.forEach(((t,n)=>{c(t),t.Attribute&&(t.Attribute.LeadingWhite=" "),e.Token_VarCommaList[n]})),e.Token_Equals){p(e.Token_Equals),c(e.Token_Equals);let t=[],n=[];e.ExprList.forEach(((o,r)=>{null!=o&&(r<e.VarList.length?(t.push(o),n.push(e.Token_ExprCommaList[r])):"CallExpr"!=o.Type&&"ParenExpr"!=o.Type&&"VargLiteral"!=o.Type&&"BinopExpr"!=o.Type&&"UnopExpr"!=o.Type||(t.push(o),n.push(e.Token_ExprCommaList[r])))})),e.ExprList=t,e.CommaList=n,e.ExprList.forEach(((t,n)=>{null!=t&&(a(t),f(t),null!=e.Token_ExprCommaList[n]&&e.ExprList.length-1==n&&(e.Token_ExprCommaList[n]=null))}))}}else if("LocalFunctionStat"==e.Type)c(e.FunctionStat.Token_Function),c(e.FunctionStat.NameChain[0]),e.FunctionStat.ArgList.forEach(((t,n)=>{n>0?c(t):p(t);let o=e.FunctionStat.Token_ArgCommaList[n];o&&p(o)})),e.FunctionStat.ArgList.length>0&&e.FunctionStat.Token_Varg?(p(e.FunctionStat.Token_Varg),c(e.FunctionStat.Token_Varg)):e.FunctionStat.Token_Varg&&p(e.FunctionStat.Token_Varg),p(e.FunctionStat.Token_OpenParen),p(e.FunctionStat.Token_CloseParen),k(e.FunctionStat.Token_CloseParen,e.FunctionStat.Body,e.FunctionStat.Token_End);else if("FunctionStat"==e.Type)e.NameChain.forEach(((t,n)=>{0==n&&c(t),e.Token_NameChainSeperator[n]})),e.ArgList.forEach(((t,n)=>{n>0&&c(t),e.Token_ArgCommaList[n]})),e.ArgList.length>0&&e.Token_Varg&&c(e.Token_Varg),k(e.Token_CloseParen,e.Body,e.Token_End);else if("RepeatStat"==e.Type)k(e.Token_Repeat,e.Body,e.Token_Until),a(e.Condition),f(e.Condition);else if("GenericForStat"==e.Type)e.VarList.forEach(((t,n)=>{c(t),e.Token_VarCommaList[n]})),c(e.Token_In),e.GeneratorList.forEach(((t,n)=>{a(t),f(t),e.Token_GeneratorCommaList[n]})),c(e.Token_Do),k(e.Token_Do,e.Body,e.Token_End);else if("NumericForStat"==e.Type)e.VarList.forEach(((t,n)=>{c(t),e.Token_VarCommaList[n]})),c(e.Token_Equals),e.RangeList.forEach(((t,n)=>{a(t),f(t),e.Token_RangeCommaList[n]})),c(e.Token_Do),k(e.Token_Do,e.Body,e.Token_End);else if("WhileStat"==e.Type)a(e.Condition),f(e.Condition),c(e.Token_Do),k(e.Token_Do,e.Body,e.Token_End);else if("DoStat"==e.Type)k(e.Token_Do,e.Body,e.Token_End);else if("IfStat"==e.Type){a(e.Condition),f(e.Condition),c(e.Token_Then);let t=e.Token_Then,n=e.Body;e.ElseClauseList.forEach((e=>{k(0,n,e.Token),t=e.Token,null!=e.Condition&&(a(e.Condition),f(e.Condition),c(e.Token_Then),t=e.Token_Then),n=e.Body})),k(0,n,e.Token_End)}else"CallExprStat"==e.Type?a(e.Expression):"CompoundStat"==e.Type?(a(e.Lhs),a(e.Rhs),f(e.Lhs),f(e.Rhs),c(e.Token_Compound)):"AssignmentStat"==e.Type?(e.Lhs.forEach(((t,n)=>{a(t),n>0&&f(t),e.Token_LhsSeperatorList[n]})),c(e.Token_Equals),e.Rhs.forEach(((t,n)=>{a(t),f(t),e.Token_RhsSeperatorList[n]}))):t(!1,"Unreachable")},i(n)}(i,r.Indentation);let s=g(i);return s=`${s}`,s};var A={...V};export{A};
