import{W as a}from"./chunk-asai-DwBdIxdo.js";import{d as e,e as l,r as t,c as o,o as s,N as n,l as u,j as i,q as r,u as d,k as c,E as p}from"./chunk-asai-BcUlmSst.js";import{_ as v}from"./entry-asai-C1GKnLJc.js";import"./chunk-asai-Bc6P8mxS.js";import"./chunk-asai-Dt9XmewB.js";import"./chunk-asai-BEbmHGt4.js";const g={class:"logo-box"},m=["src"],f={key:1},w=v(e({__name:"Logo",props:{ujt:{},data:{}},setup(e){const v=e,{$db:w,$fn:h,$dbwork:j,$global:y,$ws:k}=v.ujt,b=l(""),_=l(null),$=l(),C=l(null),S=()=>{$.value.click()},E=async a=>{if($.value.value){if(C.value=a.target.files[0],$.value.value="",!C.value)return void y.msg.fn({type:"err",con:h.lg("coview.logo.selectOne")});const e=new FileReader;e.onload=async()=>{_.value=e.result.split(",")[1],j.coviewdata.handleBeforeCancel[`${v.data.id}_upload`]=()=>new Promise((a=>{_.value=null,a(null)})),j.coviewdata.handleBeforeSave[`${v.data.id}_upload`]=()=>new Promise(((a,e)=>{try{h.api.webserver.apiPost("/api/asaiupload/manage/upbase64/?path=/webclient/assets/img/logo.png",_.value,{headers:{"Content-Type":"application/json"}}).then((l=>{if(909==l.code)return _.value=null,v.data.data.imgSrc=l.data,b.value=`?t=${(new Date).getTime()}`,void a(null);e()}))}catch(l){y.msg.fn({type:"err",con:h.lg("coview.logo.uploadError")+l.message}),e()}}))},e.readAsDataURL(C.value)}};return(e,l)=>{const v=t("el-button");return s(),o(a,{ujt:e.ujt,data:e.data},{btns:n((()=>[c(v,{type:"primary",onClick:S},{default:n((()=>[p(r(d(h).lg("coview.logo.upload")),1)])),_:1})])),default:n((()=>[u("div",g,[_.value||e.data.data.imgSrc?(s(),i("img",{key:0,alt:"",src:null==_.value?e.data.data.imgSrc+b.value:"data:image/png;base64,"+_.value},null,8,m)):(s(),i("div",f,r(d(h).lg("coview.logo.uploadTip")),1)),u("input",{ref_key:"rfInputFile",ref:$,type:"file",accept:"image/png",hidden:"",onChange:E},null,544)])])),_:1},8,["ujt","data"])}}}),[["__scopeId","data-v-88fcff6c"]]);export{w as default};
