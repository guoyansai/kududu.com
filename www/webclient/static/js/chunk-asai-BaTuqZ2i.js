import{d as l,b as e,e as o,r as t,j as a,o as s,l as n,w as i,k as c,q as d,u as p,N as u,E as r,c as m,y as g}from"./chunk-asai-BcUlmSst.js";import{_ as f}from"./entry-asai-C1GKnLJc.js";import"./chunk-asai-Dt9XmewB.js";import"./chunk-asai-BEbmHGt4.js";const v={class:"deployment"},b={class:"deployment-label"},h={class:"upload-file"},y={class:"as-up-tips"},j={class:"deployment-label"},w={key:0,class:"as-up-showlist"},k={class:"deployment-label"},x={class:"get-station"},$={class:"warning-text"},_={class:"warning-text tip-text"},V={class:"path-set"},z={key:0,class:"path-set-input"},A={class:"confirm-btn"},C=f(l({__name:"RobotDeploy",props:{ujt:{}},setup(l){const f=l,{$global:C,$fn:U}=f.ujt,R=e({file:"",ids:[],dir:"/webdata/cocontrol/deploy/"}),D=o([]),E=o("/usr/local/lib/web/run/webdata/com/webdb/"),O=o(!1),P=o([]),q=o(!1);function F(){U.api.webserver.apiGet("/api/asaidir/manage/select/?path="+R.dir).then((l=>{let e=[];l.data.forEach(((l,o)=>{e.push({value:l,label:`${o+1}.${l}`})})),P.value=e}))}function G(){R.ids=[],U.ws.cocontrol.wsApi({ty:"ethercat/getversion",db:""}).then((l=>{let e=[];for(let o of Object.keys(l.db))e.push({label:`${o}:${l.db[o]}`,value:o});D.value=e}))}function I(){let l={file:`${E.value}${R.file}`,ids:R.ids};U.ws.cocontrol.wsApi({ty:"ethercat/servoupdate",db:l}).then((l=>{C.msg.fn({type:"ok",con:U.lg("cocontrol.deploy.deploymentsuccess")})}))}function L(){O.value=!O.value}function N(l){const e={path:R.dir,list:[]};(function(l=null){return new Promise(((e,o)=>{if(l){const o=new FileReader;o.readAsDataURL(l),o.onload=()=>{e(o.result)}}else o()}))})(l).then((o=>{var t;e.list.push({name:l.name,size:l.size,data:o}),(null==(t=e.list)?void 0:t.length)&&U.api.webserver.apiPost("/api/asaijson/manage/upbatch/",e).then((l=>{F()}))}))}return F(),G(),(l,e)=>{const o=t("AsSvg"),f=t("el-upload"),F=t("el-radio-group"),S=t("el-button"),B=t("el-checkbox-group"),H=t("el-input");return s(),a("div",v,[n("div",b," 1、 "+d(p(U).lg("cocontrol.deploy.uploadbin")),1),n("div",h,[c(f,{drag:"",limit:1,accept:".bin",onOnChange:N},{default:u((()=>[c(o,{src:"common/projectupload",height:"38px",color:"var(--ccf)"}),n("div",y,d(p(U).lg("cocommon.uploadtips")),1)])),_:1})]),n("div",j,[r(" 2、"+d(p(U).lg("cocontrol.deploy.selectpackage"))+" ",1),R.file?i("",!0):(s(),m(o,{key:0,title:p(U).lg("cocontrol.deploy.selectpackagetip"),class:"infofilled",color:"var(--cz4)",height:"18px",src:"common/infofilled",ujt:l.ujt},null,8,["title","ujt"]))]),P.value.length?(s(),a("div",w,[c(F,{modelValue:R.file,"onUpdate:modelValue":e[0]||(e[0]=l=>R.file=l),options:P.value,vertical:"",borderbt:""},null,8,["modelValue","options"])])):i("",!0),n("div",k,[r(" 3、"+d(p(U).lg("cocontrol.deploy.selectstation"))+" ",1),R.ids.length?i("",!0):(s(),m(o,{key:0,title:p(U).lg("cocontrol.deploy.selectstationtip"),class:"infofilled",color:"var(--cz4)",height:"18px",src:"common/infofilled",ujt:l.ujt},null,8,["title","ujt"]))]),n("div",x,[c(S,{type:"primary",onClick:G},{default:u((()=>[r(d(p(U).lg("cocontrol.deploy.getstation")),1)])),_:1})]),c(B,{modelValue:R.ids,"onUpdate:modelValue":e[1]||(e[1]=l=>R.ids=l),options:D.value},null,8,["modelValue","options"]),n("div",$,[c(o,{color:"var(--cz4)",height:"18px",src:"common/warning",ujt:l.ujt},null,8,["ujt"]),r(" "+d(p(U).lg("cocontrol.deploy.deploymentwarning")),1)]),n("div",_,d(p(U).lg("cocontrol.deploy.deploymenttips")),1),n("div",V,[n("div",{class:"path-set-btn",onClick:L},d(p(U).lg("cocontrol.deploy.advancedset")),1),O.value?(s(),a("div",z,[c(H,{modelValue:E.value,"onUpdate:modelValue":e[2]||(e[2]=l=>E.value=l)},null,8,["modelValue"])])):i("",!0)]),n("div",A,[c(S,{disabled:!R.file||!R.ids.length,loading:q.value,type:"primary",onClick:e[3]||(e[3]=g((l=>p(C).popbox.poptips={fn:I,tips:`${p(U).lg("cocontrol.deploy.confirmupload")}【${R.file}】？`,icon:"./assets/img/robot/danger.png"}),["stop"]))},{default:u((()=>[r(d(p(U).lg("cocontrol.deploy.confirmupload")),1)])),_:1},8,["disabled","loading"])])])}}}),[["__scopeId","data-v-484bb2df"]]),U=l({__name:"default",props:{ujt:{}},setup:l=>(l,e)=>(s(),m(C,{ujt:l.ujt},null,8,["ujt"]))});export{U as default};
